import{j as e,u as j,r as s,L as g,b as v,d as N}from"./index-AnWCcf8t.js";import{f as w}from"./cards-Cy3an-VF.js";import{S as P,u as E,c as k,d as S,P as C}from"./stripeClient-DmXsUCEx.js";const q=()=>{const a=j(),n=E(),[c,x]=s.useState(!0),[o,u]=s.useState([]),[l,h]=s.useState(""),[d,p]=s.useState(null);s.useEffect(()=>{const t=setTimeout(()=>x(!1),500);return()=>clearTimeout(t)},[]),s.useEffect(()=>{(async()=>{if(n)try{const t=await k({country:"US",currency:"usd",total:{label:"Your Order",amount:5e3},requestPayerName:!0,requestPayerEmail:!0});t.canMakePayment().then(r=>{r&&p(t)}),t.on("paymentmethod",async r=>{try{const i=await S(5e3),{error:m,paymentIntent:b}=await n.confirmCardPayment(i,{payment_method:r.paymentMethod.id});if(m||!b){r.complete("fail"),console.error("PaymentIntent confirmation error:",m);return}r.complete("success"),a("/confirm-payment-pin")}catch(i){console.error("Error during PaymentRequest flow:",i),r.complete("fail")}})}catch(t){console.error("PaymentRequest init error:",t)}})()},[n,a]),s.useEffect(()=>{c||(async()=>{try{const t=await w();u(t)}catch(t){console.error("Failed to fetch saved cards:",t),h("Unable to load saved cards.")}})()},[c]);const f=()=>a(-1),y=()=>a("/confirm-payment-pin");return c?e.jsx(g,{}):e.jsx("div",{className:"bg-gray-100 min-h-screen pb-4",children:e.jsx("div",{className:"bg-blue-800 pt-4 pb-8",children:e.jsxs("div",{className:"mx-auto max-w-[480px] px-4",children:[e.jsxs("header",{className:"flex items-center px-3 py-2",children:[e.jsx("button",{onClick:f,className:"mr-3 p-0 bg-transparent","aria-label":"Go back",children:e.jsx("img",{className:"w-6 h-6",src:v,alt:"Back"})}),e.jsx("h1",{className:"text-white text-lg font-medium",children:"Payment Method"})]}),e.jsxs("div",{className:"bg-white pt-4 px-4 flex flex-col items-stretch mt-5 rounded-t-3xl h-[calc(100vh-90px)] overflow-y-auto",children:[d&&e.jsx("div",{className:"mb-4",children:e.jsx(C,{options:{paymentRequest:d}})}),l&&e.jsx("div",{className:"text-sm p-2 border border-red-600 rounded text-red-600 bg-red-100 mb-3",children:l}),o.length>0?o.map(t=>e.jsx("div",{className:"border-b-2 border-gray-200 px-0",children:e.jsxs("div",{className:"flex items-center gap-2 py-4 pr-8 cursor-pointer transition-colors hover:bg-gray-50",children:[e.jsx("span",{className:"flex items-center justify-center w-12 h-8 border border-gray-200 rounded",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"20",viewBox:"0 0 32 20",fill:"none",children:[e.jsx("rect",{width:"32",height:"20",rx:"3",fill:"#E0E0E0"}),e.jsx("text",{x:"16",y:"13",textAnchor:"middle",fontSize:"10",fill:"#333",children:t.network})]})}),e.jsxs("div",{className:"pl-4",children:[e.jsx("div",{className:"text-gray-800 text-base font-bold leading-6",children:t.network}),e.jsxs("div",{className:"text-gray-500 text-sm font-medium leading-5",children:[e.jsx("span",{className:t.isActive?"text-blue":"text-red",children:t.isActive?"Active":"Inactive"})," ","| Card Number **** ",t.last4]})]})]})},t.id)):e.jsx("p",{className:"text-gray-500 my-3 text-sm",children:"No saved cards found."}),e.jsx("div",{className:"mb-4",children:e.jsx(N,{to:"/add-new-card",className:"text-blue text-base font-medium",children:"+ Link a New Card"})}),e.jsx("div",{className:"flex items-center justify-center flex-col mt-auto mb-4",children:e.jsx("div",{className:"w-full py-4 bg-white text-blue text-lg font-medium rounded-xl text-center cursor-pointer hover:bg-blue-50",onClick:y,children:"Continue"})})]})]})})})},L=()=>e.jsx(P,{children:e.jsx(q,{})});export{L as default};
//# sourceMappingURL=SelectPaymentMethod-B49lvuz3.js.map
