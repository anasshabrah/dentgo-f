import{j as e,u as p,r,L as b,c as j}from"./index-WC5m9pr2.js";import{S as v,u as N,c as w,d as k,P}from"./stripeClient-B0uSAGAL.js";import{f as E}from"./cards-XX6NtHTw.js";const S=()=>{const n=p(),o=N(),[a,x]=r.useState(!0),[c,u]=r.useState([]),[i,y]=r.useState(""),[d,h]=r.useState(null);r.useEffect(()=>{const t=setTimeout(()=>x(!1),500);return()=>clearTimeout(t)},[]),r.useEffect(()=>{a||!o||(async()=>{try{const t=await w({country:"US",currency:"usd",total:{label:"Your Order",amount:5e3},requestPayerName:!0,requestPayerEmail:!0});await t.canMakePayment()&&h(t),t.on("paymentmethod",async s=>{try{const l=await k(5e3),{error:m,paymentIntent:g}=await o.confirmCardPayment(l,{payment_method:s.paymentMethod.id});if(m||!g){s.complete("fail"),console.error("PaymentIntent confirmation error:",m);return}s.complete("success"),n("/confirm-payment-pin")}catch(l){console.error("Error during PaymentRequest flow:",l),s.complete("fail")}})}catch(t){console.error("PaymentRequest init error:",t)}})()},[a,o,n]),r.useEffect(()=>{a||(async()=>{try{const t=await E();u(t)}catch(t){console.error("Failed to fetch saved cards:",t),y("Unable to load saved cards.")}})()},[a]);const f=()=>{n("/confirm-payment-pin")};return a?e.jsx(b,{fullscreen:!0}):e.jsx("div",{className:"bg-gray-100 dark:bg-gray-900 min-h-screen pb-4 flex flex-col",children:e.jsx("div",{className:"mx-auto max-w-[480px] px-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 pt-4 px-4 mt-5 rounded-t-3xl h-[calc(100vh-90px)] overflow-y-auto flex flex-col",children:[d?e.jsx("div",{className:"mb-4",children:e.jsx(P,{options:{paymentRequest:d}})}):e.jsxs("div",{className:"border-b-2 border-gray-200 dark:border-gray-700 mb-4 px-2 py-4",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Apple Pay / Google Pay currently unavailable."}),e.jsx("small",{className:"block text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Ensure youâ€™re on Safari (Apple Pay) or Chrome (Google Pay), using HTTPS or localhost."})]}),i&&e.jsx("div",{className:"text-sm p-2 border border-red-600 rounded text-red-600 bg-red-100 mb-3",children:i}),c.length>0?e.jsx("div",{className:"flex-1 overflow-y-auto",children:c.map(t=>e.jsx("div",{className:"border-b-2 border-gray-200 dark:border-gray-700 px-0",children:e.jsxs("div",{className:"flex items-center gap-2 py-4 pr-8 transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("span",{className:"flex items-center justify-center w-12 h-8 border border-gray-200 dark:border-gray-700 rounded",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"20",viewBox:"0 0 32 20",fill:"none",children:[e.jsx("rect",{width:"32",height:"20",rx:"3",fill:"#E0E0E0"}),e.jsx("text",{x:"16",y:"13",textAnchor:"middle",fontSize:"10",fill:"#333",children:t.network})]})}),e.jsxs("div",{className:"pl-4",children:[e.jsx("div",{className:"text-gray-800 dark:text-gray-200 text-base font-bold leading-6",children:t.network}),e.jsxs("div",{className:"text-gray-500 dark:text-gray-400 text-sm font-medium leading-5",children:[e.jsx("span",{className:t.isActive?"text-blue-800 dark:text-primary":"text-red-600",children:t.isActive?"Active":"Inactive"})," ","| Card Number **** ",t.last4]})]})]})},t.id))}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400 my-3 text-sm",children:"No saved cards found."}),e.jsx("div",{className:"mb-4",children:e.jsx(j,{to:"/add-new-card",className:"text-blue-600 dark:text-primary text-base font-medium",children:"+ Link a New Card"})}),e.jsx("div",{className:"flex items-center justify-center flex-col mt-auto mb-4",children:e.jsx("div",{className:"w-full py-4 bg-white dark:bg-gray-700 text-blue-600 dark:text-primary text-lg font-medium rounded-xl text-center cursor-pointer hover:bg-blue-50 dark:hover:bg-gray-600 transition",onClick:f,children:"Continue"})})]})})})},A=()=>e.jsx(v,{children:e.jsx(S,{})});export{A as default};
//# sourceMappingURL=SelectPaymentMethod-Dmg4C6He.js.map
